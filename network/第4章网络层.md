### 问题 4-1. 存在多种异构网络对不同网络之间的通信会造成一些麻烦，但为什么世界上还存在多种异构网络?
解答:世界 上之所以存在着多种异构网络，就是因为仅用一种体系结构的网络根本无法 满足所有用户的所有需求 。
OSI 假定全世界所有的人都在网络层使用X.25协议，并希望使用X.75协议将全球所有的X.25网络互连起来，从而实现全球任意计算机之间的通信。然而事实证明，大家并不愿意这样做，结果OSI失败了。这里的原因就是X.25网络并不能满足所有用户的需求，大量的用户还需要使用其他类型的网络。
在计算机网络发展初期，许多厂家都生产出具有自己独特体系结构的计算机网络。这些计算机网络就像一个个孤岛一样，它们是不能互相通信的。如果某公司的雇员需要同时接入三个不同厂商的计算机网络，那么他就需要用三台终端(即观看三个不同的屏幕显示)分别连接到不同的计算机网络。这显然是很不方便的。
在客观上存在多种异构计算机网络的现实情况下，普遍服务(universal service)的概念被提出来了。一个计算机通信系统若能够提供普遍服务，就表明该系统中的任何一对计算机都能够很方便地进行通信。像全世界的电话网就是能够提供普遍服务的一个成功例子。在世界上存在大量异构计算机网络(它们的网络硬件和物理地址的编址方法都不一样)的现实情况下，要获得普遍服务，的确是相当困难的事。但IP协议成功地解决了这个难题。不管你使用的具体网络采用什么样的硬件结构，但只要你的网络使用IP协议并给连接在网络上的主机分配了合法的IP地址，那么连接到这种虚拟的IP互连网上的任何一对计算机都可以很方便地进行通信。

### 问题 4-2. "IP 网关”和 "IP 路由器”是否为同义语?
解答:当初发明 TCP/IP 的研究人员使用 IP Gateway 作为网际互连的设备。我国的网络工作者曾使用过多种译名，如网间连接器、网闸、信关、联网机等，但最后由全国自然科学名词审定委员会(这个委员会现在改名为“全国科学技术名词审定委员会")在《计算机科学技术名词》中公布的 Gateway 标准译名为“网关”。
但是，在 20 世纪 90 年代初期美国 一家厂商认为，将 PGateway 改名为 IP Router似乎更加有利于设备的销售 。后来其他厂家也跟着改变产品的名称。在《计算机科学技术名词》中 Router 的标准译名是“路由器” 。现在 ，大家就都基本上不再使用网关这一名词了。
我们可以认为 "IP 网关”和 "IP 路由器”是同义语。

### 问题 4-3. IP 的英文名字是 Internet Protocol, 其标准一名是“网际协议”。那么 "IP 协议” 是否重复使用了“协议”，即“庄_协议”变成了“网际协议协议”呢?
解答:我们知道， IP 中的 "P" 就代表“协议”。因此仅仅说 IP 就已经是很清楚的了。 但为了强调 IP 是一个协议，所以在 IP 的后面还是加上了“协议”二字。如果完全用汉字来 表示 "IP 协议”，那么当然只能用一个“协议”，即“网际协议”。
和这个问题类似的还有名词 PC (Personal Computer), 即个人计算机。但有时为了强调 PC 是一个计算机，就常常在 PC 的后面加上一个“机”，变成了 "PC 机”。这当然不是表示“个 人计算机机”，而仍然是“个人计算机”。
在英文的教科书或文献中，有时会遇到 current flow 这样的写法。我们知道， current 是“电 流”，而 flow 是“流”。显然，这里也有些重复，我们不应当把 current flow 译为“电流流” 。


### 问题 4-4. 在文献中有时会见到对等连网 (peer-to-peer networking), 这是什么意思? 
解答:这有两重意思。
首先，这表示在互联网中，任何两个计算机都可以平等地进行通信 。 互联网对通信双方计算机的大小是不关心的 。 连接在互联网上的，可能是一个很小的 PC, 而通信的对方可能是一个很大的巨型机。这和早期的网络很不一样。早期的网络是以一个很大的主机为中心 ，和这个主机通信的是外围的许多功能上相对较弱的小终端 。 但后来计算机网络发展到以网络为中心，所有连接到网络(或互联网)上的计算机都是平等的。”对等”也有“对称"的意思， 但这并不是说，通信的两个计算机的大小规模必须是相似的，而是说，各种计算机都可以平 等地连接到互联网上。
其次，对等连网有时还用来说明计算机的通信方式。计算机网络原来都是采用“客户-服务器”的通信方式 。客户是通信服务的请求方 ，而服务器是通信服务的提供方。这两方在功能上显然是不对等的。客户进程比较简单，而服务器进程就比较复杂，运行服务器程序的机器也比较昂贵。但现在新的通信方式出现了，即相互通信的主机，可以互为客户方或服务器方 ，因 此产生了对等连网这样的名词 。

### 问题 4-5. 在互联网中，能否使用一个很大的交换机 (switch)来代替全部的路由器? 
解答:不行 。
交换机和路由器的功能是很不一样的。 交换机可在一个单个的网络中和若干个计算机相连，并且可以将一个计算机发送过来的帧转发给另一个计算机。从这一点上看，交换机具有集线器的转发帧的功能。但交换机比集线器的功能强很多 。 集线器在同一时间只允许一个计算机和其他计算机进行通信，但交换机允许多个计算机同时进行通信。路由器连接两个或几个网络，路由器可在网络之间转发分组(即 IP 数据报 )。特别是，这些互连的网络可以是异构的。
因此，如果是许多相同类型的网络互连在一起，那么用一个很大的交换机 (如果能够找得到)代替原来的 一 些路由器是可以的。但**目前的互联网是非常多的异构网络互连起来的， 我们不可能找到一种交换机可以代替互联网中的全部路由器。**因此，必须使用许多的路由器来进行网络互连。

### 问题 4-6. 为什么 IP 地址又称为“虚拟地址 ?
解答:这是因为 IP 地址是靠软件来维待的而不是靠硬件地址。我们好像构成了一个很大的使用统一IP协议的互连网络，但这个IP网络是虚拟的网络系统，因为它的通信系统，从层次上来看，是建筑在网络层上的，是抽象的通信系统。虽然许多大小不同的物理网络是相互连接起来了，但这些网络都有各自不同的物理层。例如，有的是无线网络，有的是光纤网络，并且数据的传送速率也可能相差很大。这些网络的数据链路层协议也是不相同的。如果我们从网络层来看这个庞大的异构网络，那么就好像是构成了一个很大的、统一的IP网络。
这种虚拟网络的地址也是虚拟的，因此IP地址义称为“虚拟地址”。实在的地址就是各网络和各主机的物理地址。
可以打一个比方。例如，我国所有的大学都有具体的、实在的门牌号码。我们通过邮政局给各大学寄信就要使用这样的具体地址。但是，假定教育部为了更加方便地管理这些大学，可以在一张图上把所有大学都按照一定的规律编上号码，而在这些具有编号的图上大学就构成了一个虚拟的全国大学网络。当教育部发达某个文件时，就可以按照指定的号码来发送给一些相关的大学。这就相当千我们在IP网络中按IP地址进行通信，但是文件的传送还是要按照各大学的具体门牌号码(相当于物理地址)由邮递员来交付。

### 问题 4-7. 有的文献上使用“虚拟分组" (virtual packet)这一名词。虚拟分组是什么意思? 
解答:虚拟分组就是 IP 数据报 。 因为互联网是由大量异构的物理网络互连而成的。这些物理网络的帧格式是各式各样的，它们的地址也可能是互不兼容的 。 路由器无法将一种格式的帧转发到另一种网络，因为另 -- 种网络无法识别与自己格式不同的帧的地址。路由器也不可能对不同的地址格式进行转换。
为了解决这一问题， IP 协议定义了 IP 数据报的格式。所有连接在互联网中的路由器都能识别 IP 数据报的 IP 地址，因此能够对 IP 数据报进行转发(在进行转发时当然要调用 ARP 协议以便获得相应的硬件地址)。我们知道， IP 数据报是作为物理网络的帧的数据部分。各个物理网络在转发帧时，是根据帧首部中的硬件地址而不看(实际上也看不见)帧的数据部分 。
由千所有的物理网络都看不见所传送的帧里面的 IP 数据报，这样就使得 IP 数据报得到 “虚拟分组”这样的名称 。

### <4-08> IP地址方案与我国电话号码体制的主要不同点是什么? 
解答:最主要有三个不同点
首先， IP 地址是定长的，因此在互联网上的 IP 地址总数是 一 定的 。 如果 IPv4 的地址用完了，那么就要过渡到具有更大地址空间的 IPv6。对于 IPv4 来说，每一个 IP 地址是固定的32 位 二 进制数字。 
但我国的固定电话号码是不定长度的，全国电话号码的总容量并没有上限。区号如果不够，就可以增加区号。 一个区内的电话局不够了，可以增加电话局的数目。区号可以不一致。 我国规定大城市区号是两位，如北京是 10, 南京是 25, 等等。但有的省各城市的区号都是 三 位，没有两位。而各城市电话号码的位数也是不固定的。根据城市人口的增长情况，电话号码的位数可以逐渐增多 。 可以从五位增长到六位，再增长到七位或八位。
其次， IP 地址与主机所在的地理位置无关。 IP 地址中并没有规定哪几位是分配给哪个地 理位置(我们应当注意到，在 CIDR 体制中，可以按地址块分配给某地的某个机构)，但在我 国的固定电话号码体制中，前面的区号(两位或三位)表示地理位置(按行政划分的城市范 围)，在后面的号码中前三位是电话交换机的编号，也具有固定的地理位置，最后几位则是分 配给连接到这个交换机的各电话机的编号 。 因此，一个固定电话号码= (区号)+(交换机 编号)+(电话机编号) 。
最后，每一个主机的 IP 地址在全世界是唯一的，没有重复的 IP 地址。但我们在家中可 以并联多个电话机，这些电话机都具有相同的电话号码。虽然我们不能用这些电话机同时拨 打电话，但可以在接通电话后，几个人同时使用这些并联的电话机和对方进行双向通话。

 种调用过程的 。 因此，在虚拟的 IP 网络上用 IP 地址进行通信给广大的计算机用户带来很大 的方便 。
<4-08> IP地址方案与我国电话号码体制的主要不同点是什么? 解答:最主要有三个不同点
首先， IP 地址是定长的，因此在互联网上的 IP 地址总数是 一 定的 。 如果 IPv4 的地址用
完了，那么就要过渡到具有更大地址空间的 IPv6。对于 IPv4 来说，每一个 IP 地址是固定的
32 位 二 进制数字。 但我国的固定电话号码是不定长度的，全国电话号码的总容量并没有上限。区号如果不
够，就可以增加区号。 一 个区内的电话局不够了，可以增加电话局的数目。区号可以不一致。 我国规定大城市区号是两位，如北京是 10, 南京是 25, 等等。但有的省各城市的区号都是 三 位，没有两位。而各城市电话号码的位数也是不固定的。根据城市人口的增长情况，电话号 码的位数可以逐渐增多 。 可以从五位增长到六位，再增长到七位或八位。
其次， IP 地址与主机所在的地理位置无关。 IP 地址中并没有规定哪几位是分配给哪个地 理位置(我们应当注意到，在 CIDR 体制中，可以按地址块分配给某地的某个机构)，但在我 国的固定电话号码体制中，前面的区号(两位或三位)表示地理位置(按行政划分的城市范 围)，在后面的号码中前三位是电话交换机的编号，也具有固定的地理位置，最后几位则是分 配给连接到这个交换机的各电话机的编号 。 因此，一个固定电话号码= (区号)+(交换机 编号)+(电话机编号) 。
最后，每 一 个主机的 IP 地址在全世界是唯一的，没有重复的 IP 地址。但我们在家中可 以并联多个电话机，这些电话机都具有相同的电话号码。虽然我们不能用这些电话机同时拨 打电话，但可以在接通电话后，几个人同时使用这些并联的电话机和对方进行双向通话。

### 【4-09 】试回答下列问题:
(1) 子网掩码为 255.255.255.0 代表什么意思?
(2) 一 网络现在的掩码为 255.255.255.248, 问该网络能够连接多少个主机?
(3) - A 类网络和 一 B 类网络的子网号（主机号中可以借出来若干位用来划分子网，借出来的就是子网号） subnet-id 分别为 16 个 1 和 8 个 I, 问这两个网络的子网掩码有何不同?
(4) 一个 B 类地址的子网掩码是 255.255.240.0, 试问在其中每一个子网上的主机数最多是多少?
(5) - A 类网络的子网掩码为 255.255.0.255, 它是否为一个有效的子网掩码? 
(6) 某个 IP 地址的十六进制表示是 C2.2F.14.81. 试将其转换为点分十进制的形式。这个地址是哪一类 IP地址?
(7) C 类网络使用子网掩码有无实际意义?为什么?
解答: 具体分析如下:
(1) 可以是 C 类地址对应的子网掩码默认值，也可以是 A 类或 B 类地址的掩码，这时主机号由最后 8 位决定，而路由器寻找网络由前 24 位决定 。 
(2) 分析一下IP地址中最后一个字节:
 248= 128 +64+32+ 16+8, 一共用掉 8 位中的 5 位，剩下 3 位分配给主机号。扣除全 0 和全 l 的主机号，可用的共 6 个主机号。
(3) A类网络的掩码前面有 8个 l, 子网号 subnet-id用了 16个 l, 因此掩码有 24个 1 和 8 个 0。
B类网络的掩码前面有16个I, 子网号subnet-id用了8个1, 因此掩码有24个l和8 个 0。
可见这两个网络的子网掩码一样，但它们的子网数目不同 。
(4) IP 地址中的 第 3 个字节是 240= 128+64+32+ 16, 表明子网号 subnet-id 用了 4 个 1。 B类网络的掩码前面是16个1。可见这个网络的子网掩码为20个1, 剩下后面12个0。因此 每 一 个子网上的主机最多可有 212 — 2 = 4094 个(不使用全 0 和全 l 的主机号)。
(5) 是一个有效的子网掩码，但不推荐这样使用，因为子网中的 1 不是连续的。
(6) 把十 六进制的数转换为十进制的数:
C216 = 12 x 16 + 2 = 192 + 2 = 194 
2F16 = 2 x 16 + 15 = 32 + 15 = 47 
1416= 1 X 16+4= 16+4=20 
8116=8 X J6+ 1= 128+ 1= 129
因此，点分十六进制地址 C2.2F.14.81 =点分十进制地址 194.47.20.129,是C类地址。
(7) 有实际意义。对千小网络这样做还可进一步划分几个子网 。
例如，一个 C 网络可以再划分为 6 个子网(使用地址中的最后一个字节的前三位)，剩下的 5 位用来分配给主机，每个子网最多可以有 30 个主机 。这时的掩码是 27 个 1 , 后面5个0。

### <4-10> 试辨认以下 lP地址的网络类别。 
(1) 128.36.1 99.3
(2) 21.12.240.17 
(3) 183.194.76.253 
(4) 192.12.69.248 
(5) 89.3.0.1
(6) 200.3.6.2
解答: (2)和(5)是 A 类，因为第一位(类别位)是 0。 
(1)和(3)是 B 类，因为前两位(类别位)是 10。 
(4)和(6)是C类，因为前三位(类别位)是 110。

### 【4-11 】 IP 数据报中的首部检验和并不检验数据报中的数据。这样做的最大好处是什么?缺点是什么?
解答: 好处是，不检验数据部分可以加快检验的过程，使转发分组更快。
缺点是，数据部分出现差错时不能及早发现。即使是到达了终点，目的主机中的 IP 也仍然不检查数据部分是否正确 。当 IP 数据报的数据部分送交上面的运输层时，运输层的 TCP 才检查收到的数据有无差错 。

### <4-12 > 当某个路由器发现一 IP 数据报的首部检验和有差错时，为什么采取丢弃的办法 而不是要求源站重传此数据报?计算首部检验和为什么不采用 CRC 检验码?
解答: IP **首部中的源地址也可能变成错误的**，要求错误的源地址重传数据报是没有意义的。不使用 CRC 可减少路由器进行检验的时间。

### <4-13 >设 IP 数据报使用固定首部，其各字段的具体数值如图 T-4-13 所示(除 IP 地址 外，均为十进制表示)。试用二进制运算方法计算应当写入到首部检验和字段 中的数值(用二进制表示)。
解答:把以上的数据写成二进制数字，按每 16位对齐，然后计算反码运算的和:
本题只要仔细一些，就不会算错。但务请注意进位。
例如，最低位相加，一共有 4 个 1, 相加后得二进制的 100, 把最低位的 0 写下，作为和 的最低位。进位中的 0 不必管它，进位中的 1 要与右边第 3 位相加。
右边第 2 位相加时，只有一个 1, 相加后得 1, 没有进位。把 l 写在右边第 2 位上。
右边第 3 位相加时，共有 4个 1 和一个进位的 1, 即总共 5 个 1, 相加后得 101。把这个 和最右边的 1 写在和的右边第 3 位上。进位的 1 应当与右边第 5 位的数字相加，等等。

### 【4-14】重新计算上题，但使用十六进制运算方法 (每 16 位二进制数字转换为 4 个十六进制数字，再按十六进制加法规则计算)。比较这两种方法。
 解答:这两种方法得出的结果是一样的。

 ### <4-15 > 什么是最大传送单元 MTU? 它和 IP 数据报首部中的哪个字段有关系? 
解答:我们知道，在 IP 层下面的每一种数据链路层都规定了一个帧所能传送的数据的最大值。这数值称为 (Ip 层下面的数据链路层所能够传送的)最大传送单元 MTU。当 IP 数据 报封装成链路层的帧时，此数据报的总长度(即首部加上数据部分)一定不能超过下面的数据链路层的 MTU 值。
显然， MTU 就是 IP 数据报首部中的“总长度字段”的上限值。需要注意的是。这个总长度字段是 16 位，因此这个字段可以表示的最大数值是 i16- l, 即 65535 字节。但实际上， 下面的数据链路层往往限制了 IP 数据报的总长度要远远小千这个数值。
总之， IP 数据报首部中的总长度既不能超过 65535 字节，也不能超过数据链路层容许的MTU 值 。或者用公式表示为 :
IP 数据报首部中的总长度 <= min{MTU, 65535}
图 T-4-15 表明 IP 数据报的总长度就是数据链路层的 MAC 帧的数据部分。但 MTU 在这个图中并未表示出来，因为 MTU 是 MAC 帧的数据部分的上限值。

### 【4-16】在互联网中将 IP 数据报分片传送的数据报在最后的目的主机进行组装 。还可以 有另 一种做法，即数据报片通过一个网络就进行一次组装。试比较这两种方法的优劣 。
 解答: 在目的站而不是在中间的路由器进行组装是由于:
(I) 路由器处理数据报更简单些;
(2) 并非所有的数据报片都经过同样的路由器，因此在每一个中间的路由器进行组装可能总会缺少几个数据报片;
(3) 也许分组 后面还要经过一个网络，它还要给这些数据报片划分成更小的片。如果在中间的路由器进行组装就可能会组装多次。

### <4-17> 一个3200位长的TCP报文传到IP层，加上160位的首部后成为数据报。下面 的互联网 由两个局域网通过路由器连接起来 ，但第二个局域网所能传送的最长 数据帧中的数据部分只有 1200 位，因此数据报在路由器必须进行分片 。 试问 第二个局域网向其上层要传送多少比特的数据(这 里 的“数据“ 当然指的是局 域网看见的数据)?
解答:第 二个局域网所能传送的最长数据帧中的数据部分 只有 1200bit, 可见每 一 个 IP 数 据报的最大长度是 1200b仆，故其数据部分最多为:
IP 数据报的总长度- IP 数据报的 首部= 1200- 160 = 1040 bit
而TCP交给IP的数据共3200bit=1040+1040+1040+80, 因此3200bit的数据必须划 分为 4 个数据报片，如图 T-4-17 所示。
图中的 HI, H2, H3, H4 分别是这 四个数据报片的首部，其长度都是 160 bit C但里面的内 容并不相同)，而 TCP_!, TCP_2, TCP_3, TCP_4 分别是这四个数据报片的数据部分，其长度 分别为 I040 bit, I040 bit, I040 bit 和 80 bit。这四个数据报片的总长度(首部加上数据部分) 分别为 1200 bit, 1200 bit, 1200 bit 和 240 bit
上面这些就是第二个局域网向其上层要传送的数据 。 因此，第二个局域网向上传送 1200 + 1200 + 1200 + 240 = 3840 bit。


